/* =========================================
   Vivora Illustration — Full Styles
   ・HTML/CSS分離
   ・方眼紙は .artboard 内だけ
   ・ON/OFF: #gridToggle のチェックで切替（CSSのみ）
========================================= */

/* -------- Tokens -------- */
:root{
  /* colors */
  --bg: #e9e4de;          /* ページ背景（薄ベージュ） */
  --panel: #ffffff;       /* 白パネル */
  --tile: #f2eee9;        /* ごく薄いタイル色（枠） */
  --line: #d8d2cc;        /* 枠線 */
  --text: #333333;

  /* layout */
  --app-max-w: 1440px;
  --app-pad-x: 24px;

  /* artboard size (固定) */
  --art-w: 1280px;
  --art-h: 820px;
  --art-radius: 14px;

  /* grid (方眼紙) */
  /* ファイルパスはプロジェクトに合わせて調整してください */
  /* 例: /public/grid/W_4.51 mm・H_4.54 mm.png */
  --grid-img: url("/public/grid/W_4.51 mm・H_4.54 mm.png");
  --grid-opacity: 0.65;         /* 0〜1 */
  --grid-blend-mode: multiply;  /* 背景となじませる */
}

/* -------- Reset（最小限） -------- */
* { box-sizing: border-box; }
html, body { height: 100%; }
body{
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
    "Hiragino Sans", "Noto Sans JP", "Helvetica Neue", Arial, sans-serif;
  color: var(--text);
  background: var(--bg);
}

/* -------- App Frame -------- */
.app{
  max-width: var(--app-max-w);
  margin: 20px auto 40px;
  padding: 0 var(--app-pad-x);
}

/* ===== Topbar（キャンバスの外） ===== */
.topbar{
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 16px;
  margin-bottom: 10px;
}

.title{
  margin: 0;
  font-size: 16px;
  font-weight: 500;
  letter-spacing: .2px;
}

.nextstep{
  appearance: none;
  border: 1px solid var(--line);
  background: var(--panel);
  padding: 6px 12px;
  font-size: 13px;
  border-radius: 10px;
  cursor: pointer;
}
.nextstep:hover{ filter: brightness(0.98); }

/* ===== Stage／Artboard ===== */
.stage{
  display: grid;
  justify-content: center;   /* 中央寄せ */
}

.grid-control{
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 8px;
  margin: 6px 0 8px;
  user-select: none;
}
.grid-control > input{
  width: 16px;
  height: 16px;
}
.grid-control > label{
  font-size: 12px;
  opacity: .8;
  cursor: pointer;
}

/* アートボード本体（固定 1280×820） */
.artboard{
  position: relative;
  width: var(--art-w);
  height: var(--art-h);
  background: var(--panel);
  border: 1px solid var(--line);
  border-radius: var(--art-radius);
  /* 外周のごく薄いベージュ枠（添付イメージの雰囲気） */
  box-shadow:
    inset 0 0 0 8px var(--tile),       /* 内側ベージュ帯 */
    0 1px 0 rgba(0,0,0,.04),
    0 6px 20px rgba(0,0,0,.05);
  overflow: hidden; /* 方眼紙と中身をクリップ */
}

/* ====== 方眼紙（artboard内だけ） ======
   ::before を “最背面” オーバーレイとして使用 */
.artboard::before{
  content: "";
  position: absolute;
  inset: 0;
  background-image: var(--grid-img);
  background-repeat: repeat;
  background-position: center center;
  background-size: auto;         /* 元画像ピッチを保持（等倍） */
  opacity: var(--grid-opacity);
  mix-blend-mode: var(--grid-blend-mode);
  pointer-events: none;          /* 透過して操作可 */
  z-index: 0;                    /* 最背面 */
}

/* チェックが外れたら方眼紙を非表示（CSSのみで切替） */
/* 構造: .grid-control > input + label + .artboard */
#gridToggle:not(:checked) + label + .artboard::before{
  opacity: 0;
}

/* ===== マネキン ===== */
.mannequin{
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%); /* 完全中央 */
  height: min(560px, 68%);          /* 画像高さ（比率で安全） */
  opacity: .9;
  z-index: 1;                       /* 方眼紙より上 */
  user-select: none;
  -webkit-user-drag: none;
}

/* ===== 右サイドのツールレール（土台のみ） ===== */
.rail{
  position: absolute;
  top: 24px;
  right: 16px;
  width: 88px;
  height: calc(100% - 48px);
  border-radius: 12px;
  background: linear-gradient(#f7f4f0, #f2eee9);
  border: 1px solid var(--line);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.5);
  z-index: 2;
  pointer-events: none; /* まずは土台なので操作不可。後で解除 */
}

/* ===== 小さなレスポンシブ保護（縮小時のはみ出し対策） ===== */
@media (max-width: 1320px){
  .app{ padding: 0 16px; }
}
