/* ============ 1) ルート変数 / ベース ============ */
:root{
  /* カラーパレット */
  --bg:#f3ece7;           /* 画面の背景 */
  --panel:#f7f2ee;        /* サイド／ツールバーの淡色 */
  --line:#e1d9d4;         /* 枠線の基調色 */
  --text:#333;            /* 文字色 */
  --accent:#222;          /* 強調色（アクティブ等） */

  /* 影・効果 */
  --shadow:0 6px 18px rgba(0,0,0,.06);

  /* スペーシングの基準（調整用） */
  --gap-sm:8px;
  --gap-md:12px;
  --gap-lg:16px;
  --gap-xl:24px;
}

*{ box-sizing:border-box; margin:0; padding:0; }
html,body{ height:100%; }
body{
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,"Helvetica Neue",Arial,sans-serif;
}

/* ============ 2) アプリ全体のレイアウト ============ */
/* 左：ワークエリア、右：サイドバー（固定幅） */
.app{
  display:grid;
  grid-template-columns: 1fr 320px;
  grid-template-rows: auto auto 1fr;
  grid-template-areas:
    "header  sidebar"
    "toolbar sidebar"
    "canvas  sidebar";
  height:100vh;
}

/* ============ 3) ヘッダー（タイトル＋性別タブ） ============ */
header{
  grid-area: header;

  /* タイトルを1行専有 → ボタン列は次段（wrap） */
  display:flex;
  flex-wrap:wrap;
  align-items:flex-start;

  /* ここが“タイトルとボタンの縦の感覚”を作る要の設定 */
  padding: 26px 24px;          /* ← ヘッダー全体の上下余白（必要なら数値だけ調整） */
  column-gap: 36px;            /* タイトルと右側要素の水平間隔 */
}

header h1{
  /* タイトルを1行丸ごと使わせる（下段にボタン） */
  flex: 0 0 100%;
  font: 500 18px/1 'Playfair Display', serif;
  color:#222;

  /* ↓ タイトルと性別ボタン群の“縦の感覚”をここで確実に確保 */
  margin: 0 0 24px 0;
}

/* 性別タブ群（.gender） */
.gender{
  display:flex;
  gap:14px;                  /* ボタン同士の間隔 */
}

/* 性別ボタン：HTMLが .gbtn を付けているので両対応にして安全に */
.gender button,
.gender .gbtn{
  border:1px solid var(--line);
  background:#fff;
  padding: 8px 18px;
  border-radius:18px;
  cursor:pointer;
  font-size:14px;
}

/* アクティブ状態 */
.gender button.active,
.gender .gbtn.active{
  background:var(--accent);
  color:#fff;
  border-color:var(--accent);
}

/* ============ 4) 上部ツールバー ============ */
/* 画面上の操作アイコン（Undo/Redo/Reset/Download/Upload/Save/Grid） */
.toolbar{
  grid-area:toolbar;
  display:flex;
  align-items:center;
  gap:14px;

  /* ブロックの背景。上下の線（border）は付けない方針 */
  padding:10px 16px;
  background:#fff8;
  backdrop-filter:saturate(1.2) blur(2px);
}

/* ツールバーのアイコンボタン */
.tool-btn{
  background:transparent;
  border:none;
  cursor:pointer;
  opacity:.85;
}
.tool-btn:hover{ opacity:1; }
.tool-btn img{ width:22px; height:22px; display:block; }

/* コンテンツ切替アイコン（右寄せ） */
.contentbar{
  display:flex;
  align-items:center;
  gap:10px;
  margin-left:auto;          /* ← 右端に寄せる */
}
.content-btn{
  background:#fff;
  border:1px solid var(--line);
  border-radius:10px;
  width:42px; height:42px;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer;
  transition:.15s;
}
.content-btn img{ width:26px; height:26px; display:block; }
.content-btn:hover{ transform:translateY(-2px); box-shadow:var(--shadow); }

/* ============ 5) キャンバス領域（ボード＋ステージ） ============ */
.canvas-area{
  grid-area:canvas;
  display:flex;
  flex-direction:column;
  overflow:hidden;      /* スクロールはキャンバス内部で処理 */
  /* 上下の境界線は付けない（ヘッダー／ツールバーと一体化） */
}

/* “紙”に相当する外枠（方眼紙もここに） */
#board.board{
  position:relative;
  flex:1;
  margin:16px;
  background:#fff;
  border:1px solid var(--line);
  border-radius:10px;
  box-shadow:var(--shadow);
  overflow:hidden;
}

/* 方眼紙 ON のときだけ表示される疑似要素 */
#board.board.grid::before{
  content:"";
  position:absolute; inset:0;
  background-image:
    linear-gradient(rgba(0,0,0,.06) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,0,0,.06) 1px, transparent 1px);
  background-size: 24px 24px;
  pointer-events:none;
}

/* 実際にドラッグ／ズームする平面（Pan&Zoom 対象） */
#stage{
  position:absolute; left:0; top:0;
  transform-origin:0 0;
  touch-action:none;      /* ピンチズーム対応 */
  cursor:grab;
}
#stage.grabbing{ cursor:grabbing; }

/* ベースのマネキン画像（実サイズ基準で拡縮） */
.mannequin-base{
  display:block;
  max-width:none;
  width:600px;          /* 初期の見やすい幅（任意） */
  height:auto;
  user-select:none;
  -webkit-user-drag:none;
}

/* ============ 6) 追加パーツ（レイヤ） ============ */
/* 追加要素のホルダー（選択・ドラッグ対象） */
.overlay-item{
  position:absolute;
  left:50%; top:50%;
  transform:translate(-50%,-50%);
  width:45%;
  aspect-ratio:3/4;
  pointer-events:auto;
}
.overlay-item img{
  width:100%; height:100%;
  object-fit:contain;
  user-select:none; -webkit-user-drag:none;
}
/* 選択可視化 */
.overlay-item.selected-layer{
  outline:2px dashed #6c5ce7;
  outline-offset:2px;
}
/* 色乗せ用のティント（乗算） */
.overlay-item .tint{
  position:absolute; inset:0;
  mix-blend-mode:multiply;
  pointer-events:none;
  border-radius:4px;
}

/* ============ 7) サイドバー（右パネル群） ============ */
aside{
  grid-area:sidebar;
  padding:16px;
  border-left:1px solid var(--line);
  background:var(--panel);
  overflow:auto;
}

/* 個別パネルの共通スタイル */
.panel{
  background:#fff;
  border:1px solid var(--line);
  border-radius:12px;
  padding:12px;
  margin-bottom:12px;
  box-shadow:var(--shadow);
}
.panel h3{
  font:500 16px/1 'Playfair Display',serif;
  margin-bottom:8px;
}

/* ポーズサムネ群 */
.pose-row{
  display:flex; gap:8px; overflow:auto;
}
.pose-row img{
  width:52px; height:80px; object-fit:contain;
  border:2px solid transparent;
  border-radius:8px;
  padding:2px; background:#fff;
  cursor:pointer;
}
.pose-row img.selected{ border-color:#222; }

/* ステーショナリー／カラーの 4 列グリッド */
.grid-4{ display:grid; grid-template-columns:repeat(4,1fr); gap:10px; }

.tool-tile, .color-tile{
  width:56px; height:56px;
  border:1px solid var(--line);
  border-radius:10px;
  background:#fff;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer;
  transition:.15s;
}
.tool-tile:hover, .color-tile:hover{ transform:translateY(-2px); box-shadow:0 8px 18px rgba(0,0,0,.08); }
.tool-tile img{ width:30px; height:30px; }
.color-tile{ border:none; }
.color-tile.add{ font-size:22px; color:#bbb; border:1px dashed var(--line); background:#fafafa; }

/* Next Step ボタン（サンプル） */
.nextstep{ display:flex; justify-content:flex-end; margin-bottom:12px; }
.nextstep button{
  background:#222; color:#fff; border:none;
  border-radius:8px; padding:10px 16px;
  cursor:pointer; font-family:'Playfair Display',serif;
}

/* ============ 8) Zoom / Opacity パネル ============ */
#zoomPanel .zoom-row{ display:flex; align-items:center; gap:10px; }
#zoomRange{ width:100%; }

.zoom-btn{
  width:34px; height:34px;
  border:1px solid var(--line);
  background:#fff; border-radius:8px;
  cursor:pointer;
}
.zoom-btn:hover{ background:#fafafa; }

.zoom-meta{
  display:flex; align-items:center; justify-content:space-between;
  margin-top:8px; font-size:13px; opacity:.8;
}

.zoom-reset{
  border:1px solid var(--line); background:#fff;
  padding:4px 10px; border-radius:8px; cursor:pointer;
}
.zoom-reset:hover{ background:#fafafa; }

/* 透明度スライダの数値表示（HTML側 #opacityVal を想定） */
#opacityPanel #opacityVal{ font-size:13px; opacity:.75; }

/* ============ 9) 微調整用ユーティリティ（必要に応じて） ============ */
/* ヘッダー下の余白を更に広げたいとき：header に .header--loose を付与 */
.header--loose h1{ margin-bottom: 36px; }

/* コンテンツアイコンを少し小さくしたい場合 */
.contentbar--compact .content-btn{ width:38px; height:38px; }
.contentbar--compact .content-btn img{ width:24px; height:24px; }

/* Pose: + タイルレイアウト */
.pose-grid{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
}

.pose-add{
  display:flex;
  align-items:center;
  justify-content:center;
  width:100%;
  aspect-ratio: 2 / 3;               /* 縦長カード */
  border:1px solid var(--line);
  border-radius:16px;
  background:#fff;
  box-shadow: var(--shadow);
  cursor:pointer;
  transition: transform .15s, box-shadow .15s;
}

.pose-add:hover{
  transform: translateY(-2px);
  box-shadow: 0 10px 22px rgba(0,0,0,.08);
}

.pose-add svg{ width:42px; height:42px; }

.pose-add:focus-visible{
  outline:3px solid #9db0ff;
  outline-offset:3px;
}

/* 視覚的には非表示、スクリーンリーダー向けテキスト */
.sr-only{
  position:absolute; width:1px; height:1px;
  padding:0; margin:-1px; overflow:hidden;
  clip:rect(0,0,0,0); white-space:nowrap; border:0;
}

