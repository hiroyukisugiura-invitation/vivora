:root{
  --bw: 1280px; --bh: 820px;         /* ボード固定 */
  --cols: 100;  --rows: 70;          /* 100×70 グリッド */
  --cw: calc(var(--bw)/var(--cols));
  --rh: calc(var(--bh)/var(--rows));

  --radius: 16px;
  --card-w: 116px;    /* 右パネル15セル内でLayers幅を確保 */
  --tool-size: 40px;  /* Stationeryボタン */
  --palette-dot: 22px;

  --line:#d9d9d9; --shadow:0 1px 2px rgba(0,0,0,.06); --text:#222;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:#fff;color:var(--text);
  font-family:Inter,-apple-system,Segoe UI,"Noto Sans JP",sans-serif}

/* header */
.topbar{display:grid;grid-template-columns:1fr auto auto;gap:12px;align-items:center;padding:14px 18px}
.app-title{margin:0;font-size:18px;font-weight:600}
.contents-buttons{display:flex;gap:10px;align-items:center}
.contents-buttons img{width:22px;height:22px;object-fit:contain}
.next-step{border:0;background:none;font-size:12px;cursor:pointer}

/* stage/board */
.stage{width:100%;height:calc(100vh - 52px);display:grid;place-items:center;overflow:hidden}
#fit{will-change:transform}
#board{position:relative;width:var(--bw);height:var(--bh);background:#fafafa;border:1px solid var(--line);
  border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}

/* grid coords (cells) */
.grid-xy{
  position:absolute;
  left:  calc(var(--x1) * var(--cw));
  top:   calc(var(--y1) * var(--rh));
  width: calc((var(--x2) - var(--x1)) * var(--cw));
  height:calc((var(--y2) - var(--y1)) * var(--rh));
}

/* canvas */
.canvas-frame{background:#fff;border:1px solid #e3e3e3;border-radius:12px}
.canvas-frame{position:absolute}
.canvas-frame .mannequin-center{
  position:absolute; left:50%; top:50%;
  width:240px; height:auto; transform:translate(-50%,-50%) scale(1);
  pointer-events:none; user-select:none; object-fit:contain;
}
.canvas-frame .zoom-pane{
  position:absolute; right:18px; top:48%; transform:translateY(-50%);
  display:grid; gap:8px; padding:8px 10px;
  border:1px solid #cfcfcf; border-radius:10px; background:#fff; box-shadow:var(--shadow);
  font-size:11px;
}
.zoom-row,.opacity-row{display:flex;align-items:center;gap:8px}
.zoom-pane input[type="range"]{width:110px}

/* right panel */
.right-panel{display:grid;grid-template-rows:auto 1fr auto;gap:14px}
.io-row{display:flex;gap:8px;justify-content:flex-end}
.io{width:26px;height:26px;border:1px solid var(--line);border-radius:8px;background:#fff;display:grid;place-items:center;padding:0;cursor:pointer}
.io img{width:18px;height:18px;object-fit:contain}

/* mid row: layers + tools */
.panel-row{display:grid;grid-template-columns:var(--card-w) 1fr;gap:10px;align-items:start}

/* layers */
.layers-column{display:grid;gap:12px}
.layer-card{width:var(--card-w);height:120px;border:1px solid var(--line);border-radius:12px;background:#fff;
  display:grid;grid-template-rows:22px 1fr 22px;overflow:hidden}
.layer-head,.layer-foot{display:flex;align-items:center;gap:6px;padding:0 6px}
.layer-head .lock{margin-left:var(--cw)} /* 「非表示」と「ロック」の間を1セル空ける */
.layer-head img,.layer-foot img{width:16px;height:16px;object-fit:contain}
.layer-body{background:radial-gradient(ellipse at center,#fafafa,#f6f6f6);
  border-top:1px dashed #ececec;border-bottom:1px dashed #ececec}

/* tools */
.tool-column{display:grid;grid-auto-rows:var(--tool-size);gap:10px;align-content:start;justify-items:center}
.tool{width:var(--tool-size);height:var(--tool-size);border:1px solid var(--line);border-radius:10px;background:#fff;
  display:grid;place-items:center;padding:0;cursor:pointer}
.tool img{width:24px;height:24px;object-fit:contain;display:block}

/* palette */
.palette{display:grid;justify-items:center;gap:10px}
.palette>button{width:var(--palette-dot);height:var(--palette-dot);border-radius:50%;border:1px solid rgba(0,0,0,.15);
  background:var(--c,#ddd);cursor:pointer}
