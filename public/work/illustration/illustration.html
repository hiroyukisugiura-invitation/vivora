<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vivora Fashion Illustration 2025</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <!-- 画面中央に固定ステージを配置（外側は非スケール領域） -->
  <div class="viewport">
    <!-- ステージ（固定寸法を transform: scale で拡縮） -->
    <div class="app" role="application" aria-label="Vivora Fashion Illustration 2025">

      <!-- Topbar（canvasの外） -->
      <div class="topbar">
        <!-- 左：Next Step + contents -->
        <div class="topbar-left stack">
          <button id="next-step" class="ghost-btn" type="button">Next Step ▶▶</button>
          <nav class="contents-button" aria-label="contents">
            <img src="/create_parts/contents_button/0_home.png"                     alt="Home"  title="Home" draggable="false"/>
            <img src="/create_parts/contents_button/1_fashion-illustrations.png"    alt="Fi"    title="Fashion Illustrations" draggable="false"/>
            <img src="/create_parts/contents_button/2_fabric-matching.png"          alt="Fm"    title="Fabric Matching" draggable="false"/>
            <img src="/create_parts/contents_button/3_clothing-design.png"          alt="Cd"    title="Clothing Design" draggable="false"/>
            <img src="/create_parts/contents_button/4_pattern-creation.png"         alt="Pc"    title="Pattern Creation" draggable="false"/>
            <img src="/create_parts/contents_button/5_grading.png"                  alt="Gd"    title="Grading" draggable="false"/>
            <img src="/create_parts/contents_button/6_print-layout-cut.png"         alt="Plc"   title="Print/Layout/Cut" draggable="false"/>
            <img src="/create_parts/contents_button/digital-dressing-kids-mode.png" alt="Dk"    title="Digital Dressing (Kids)" draggable="false"/>
          </nav>
        </div>

        <!-- 中央：ページネーム -->
        <h1 class="page-title">Vivora Fashion Illustration 2025</h1>

        <!-- 右：history -->
        <div class="history-tool" aria-label="history">
          <img src="/create_parts/create_button/retreat.png"   alt="Redo"      title="戻る" draggable="false"/>
          <img src="/create_parts/create_button/forward.png"   alt="Cycle"     title="進む" draggable="false"/>
          <img src="/create_parts/create_button/reset.png"     alt="Undo"      title="リセット" draggable="false"/>
          <img src="/create_parts/create_button/download.png"  alt="Download"  title="ダウンロード" draggable="false"/>
          <img src="/create_parts/create_button/upload.png"    alt="Upload"    title="アップロード" draggable="false"/>
          <img src="/create_parts/create_button/save.png"      alt="Save"      title="保存" draggable="false"/>
        </div>
      </div>

      <!-- Board（canvas本体） -->
      <div class="board">
        <div class="canvas-wrapper">
          <!-- Stationery（canvas内 右上：8アイコン） -->
          <div class="stationery-toolbar" aria-label="stationery">
            <img src="/create_parts/object_btn/select.png"      alt="Select"  title="選択" draggable="false"/>
            <img src="/create_parts/object_btn/square.png"      alt="Square"  title="図形" draggable="false"/>
            <img src="/create_parts/object_btn/brush.png"       alt="Brush"   title="ペン" draggable="false"/>
            <img src="/create_parts/object_btn/eraser.png"      alt="Eraser"  title="ケシゴム" draggable="false"/>
            <img src="/create_parts/object_btn/sentence.png"    alt="Text"    title="テキスト" draggable="false"/>
            <img src="/create_parts/object_btn/opasity_ber.png" alt="Opacity" title="透明度" draggable="false"/>
            <img src="/create_parts/object_btn/graph_paper.png" alt="Grid"    title="方眼紙" draggable="false"/>
            <img src="/create_parts/object_btn/layer.png"       alt="Layer"   title="レイヤー" draggable="false"/>
          </div>

          <!-- マネキン（常にキャンバス中心） -->
          <img id="mannequin"
               src="/mannequin/mannequin_woman/mannequin_woman_front.png"
               alt="Mannequin (Woman Front)" draggable="false"/>
        </div>
      </div>
    </div>
  </div>

  <!-- ================================
       JS（HTMLと統合）
       - ステージ自動フィット（固定寸法 → 画面にscaleでフィット）
       - 将来機能のクリックフック
  ================================= -->
  <script>
    // ステージを画面にフィットさせる（イラレ風：固定寸法をscaleで拡縮）
    (function(){
      const css = () => getComputedStyle(document.documentElement);
      const num = v => parseFloat(v) || 0;

      function fitStage(){
        const BASE_W = num(css().getPropertyValue('--base-w')) || 1280;
        const BASE_H = num(css().getPropertyValue('--base-h')) || 820;
        const MARGIN = num(css().getPropertyValue('--viewport-margin')) || 32;

        const vw = window.innerWidth  - MARGIN*2;
        const vh = window.innerHeight - MARGIN*2;
        const s  = Math.max(0.5, Math.min(vw/BASE_W, vh/BASE_H)); // 最小0.5倍（必要なら調整）
        document.documentElement.style.setProperty('--app-scale', s);
      }

      window.addEventListener('resize', fitStage, { passive:true });
      window.addEventListener('orientationchange', fitStage, { passive:true });
      document.addEventListener('DOMContentLoaded', fitStage);
    })();

    // 画像ドラッグや長押し選択を抑止（UI誤操作を防ぐ）
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('img').forEach(img => {
        img.addEventListener('mousedown', e => e.preventDefault());
        img.addEventListener('dragstart', e => e.preventDefault());
      });

      // 将来機能のクリック・フック（今はプレースホルダ）
      const clickable = document.querySelectorAll(
        '.stationery-toolbar img, .history-tool img, .contents-button img, #next-step'
      );
      clickable.forEach(el => el.addEventListener('click', () => {
        // TODO: 実処理を後で追加
        // console.log('clicked:', el.alt || el.id);
      }));
    });
  </script>
</body>
</html>
